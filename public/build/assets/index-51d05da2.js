const d=/#/g,C=/&/g,O=/=/g,f=/\+/g,I=/%5e/gi,p=/%60/gi,P=/%7c/gi,T=/%20/gi;function w(e){return encodeURI(""+e).replace(P,"|")}function i(e){return w(typeof e=="string"?e:JSON.stringify(e)).replace(f,"%2B").replace(T,"+").replace(d,"%23").replace(C,"%26").replace(p,"`").replace(I,"^")}function a(e){return i(e).replace(O,"%3D")}function _(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function N(e){return _(e.replace(f," "))}function Q(e){return _(e.replace(f," "))}function S(e=""){const t={};e[0]==="?"&&(e=e.slice(1));for(const r of e.split("&")){const o=r.match(/([^=]+)=?(.*)/)||[];if(o.length<2)continue;const n=N(o[1]);if(n==="__proto__"||n==="constructor")continue;const c=Q(o[2]||"");t[n]===void 0?t[n]=c:Array.isArray(t[n])?t[n].push(c):t[n]=[t[n],c]}return t}function U(e,t){return(typeof t=="number"||typeof t=="boolean")&&(t=String(t)),t?Array.isArray(t)?t.map(r=>`${a(e)}=${i(r)}`).join("&"):`${a(e)}=${i(t)}`:a(e)}function b(e){return Object.keys(e).filter(t=>e[t]!==void 0).map(t=>U(t,e[t])).filter(Boolean).join("&")}const j=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,$=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,x=/^([/\\]\s*){2,}[^/\\]/;function E(e,t={}){return typeof t=="boolean"&&(t={acceptRelative:t}),t.strict?j.test(e):$.test(e)||(t.acceptRelative?x.test(e):!1)}const G=/\/$|\/\?|\/#/;function h(e="",t){return t?G.test(e):e.endsWith("/")}function B(e="",t){if(!t)return(h(e)?e.slice(0,-1):e)||"/";if(!h(e,!0))return e||"/";let r=e,o="";const n=e.indexOf("#");n>=0&&(r=e.slice(0,n),o=e.slice(n));const[c,...s]=r.split("?");return(c.slice(0,-1)||"/")+(s.length>0?`?${s.join("?")}`:"")+o}function H(e="",t){if(!t)return e.endsWith("/")?e:e+"/";if(h(e,!0))return e||"/";let r=e,o="";const n=e.indexOf("#");if(n>=0&&(r=e.slice(0,n),o=e.slice(n),!r))return o;const[c,...s]=r.split("?");return c+"/"+(s.length>0?`?${s.join("?")}`:"")+o}function X(e,t){if(K(t)||E(e))return e;const r=B(t);return e.startsWith(r)?e:M(r,e)}function J(e,t){const r=m(e),o={...S(r.search),...t};return r.search=b(o),V(r)}function K(e){return!e||e==="/"}function W(e){return e&&e!=="/"}const D=/^\.?\//;function M(e,...t){let r=e||"";for(const o of t.filter(n=>W(n)))if(r){const n=o.replace(D,"");r=H(r)+n}else r=o;return r}function m(e="",t){const r=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(r){const[,l,u=""]=r;return{protocol:l.toLowerCase(),pathname:u,href:l+u,auth:"",host:"",search:"",hash:""}}if(!E(e,{acceptRelative:!0}))return t?m(t+e):R(e);const[,o="",n,c=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,s="",g=""]=c.match(/([^#/?]*)(.*)?/)||[],{pathname:y,search:A,hash:L}=R(g.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:o.toLowerCase(),auth:n?n.slice(0,Math.max(0,n.length-1)):"",host:s,pathname:y,search:A,hash:L}}function R(e=""){const[t="",r="",o=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:t,search:r,hash:o}}function V(e){const t=e.pathname||"",r=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",o=e.hash||"",n=e.auth?e.auth+"@":"",c=e.host||"";return(e.protocol?e.protocol+"//":"")+n+c+t+r+o}export{X as a,b as s,J as w};
